{% extends 'website/base.html' %}
{% load staticfiles %}
{% load cards %}
{% load utils %}
{% load divtags %}

{% block header %}
    <link href="{% static 'inventory/css/general.css' %}" rel="stylesheet" type="text/css" />
{% endblock header %}


{% block content %}
<!-- TODO: Fikse modals og for loop til avatarmenyen -->
<!-- Green overhead menu -->
<div class="section hs-green white-text">
	<div class="container">
		<div class="row">
			<div class="col s12 white-text">
				<h4>Inventar</h4>
			</div>
		</div>
	</div>
</div>
{% if perms.inventory %}
<div class="section white">
	<div class="container">
		<!-- Start admin menu-->
		<div class="row">
			<div class="col s12">
				<div class="card">
					<div class="card-content">
						<span class="card-title">Administrator meny</span>
					</div>
					<div class="card-action white-text">
						<!-- Modal Triggers -->
						{% if perms.inventory.add_item %}
						<a href="#add_item" class="btn modal-trigger">Legg til gjenstand</a>
						{% endif %}
						{% if perms.inventory.add_tag %}
						<a href="#add_tag" class="btn modal-trigger">Legg til tag</a>
						{% endif %}
						{% if perms.inventory.add_loan %}
						<a href="#reg_loan" class="btn modal-trigger">Registrer utlån</a>
						<a href="#adm_loan" class="btn modal-trigger">Administrerutlån</a>
						{% endif %}
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- Modals -->
	<div id="add_item" class="modal">
		<div class="modal-content">
			<p>Add item</p>
			<form method="post">
				{% csrf_token %}
				{{ itemform.as_p }}
			<input type="submit" name="item"/>
			</form>
		</div>
	</div>
	<div id="add_tag" class="modal">
		<div class="modal-content">
			<p>Add tag</p>
			<form method="POST">
				{% csrf_token %}
				{% for field in tagform %}
				<div class="input-field col s12">
					{{ field }}
					<label for="{{ field.id_from_label }}">{{ field.label }}</label>
				</div>
				{% endfor %}
				<input type="submit" name="tag" class="btn btn-large">Submit </input>
			</form>
		</div>
	</div>
	<div id="reg_loan" class="modal">
		<!--  trenger FIX -->
	</div>
	<div id="adm_loan" class="modal">
		<!-- add modal from administrate_loan.html -->
	</div>
	<div class="divider"></div>
</div>
<!-- End admin menu-->
{% endif %}
<div class="section white">
	<div class="container">
		<!-- start main content -->
		<div class="row">
			{% if perms.inventory %}
			<div class="col s6">
				<a href="{% url 'inventory:my_loans' %}"  class="btn">Mine lån</a>
			</div>
			{% endif %}
			<!-- TODO: knytte søkefelt til items -->
			<div class="col s6">
				<input type="text" name="search" placeholder="Søk">
			</div>
		</div>
		<div class="row">
			<!-- Rabperry Pi category skeleton-->
			<div class="col s12">
				<ul class="collapsible">
						{% for tag in tags %}
						<li>
							<div class="collapsible-header"><i class="material-icons">filter_drama</i>{{ tag.name }}</div>
							<div class="collapsible-body">
								<ul class="collection">
									{% for item in tag.get_visible_items %}
									<li class="collection-item avatar">
										<img class="circle" src="{{ item.thumbnail.url }}"/>
										<p>{{ item.description }}</p>
										<a href="#!" class="secondary-content btn-flat">Lån Ut</a>
									</li>
									{% endfor %}
								</ul>
							</div>
						</li>
						{% endfor %}
				</ul>
			</div>
		</div>
	</div>
</div>
<script>
	M.AutoInit();
</script>
{% endblock content %}
