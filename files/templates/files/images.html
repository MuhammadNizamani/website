{% extends 'website/base.html' %}
{% load staticfiles %}

{% block head %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
{% endblock head %}

{% block content %}
<div class="container">
	<form id="searchForm" action="/files/images/" method="post">
		{% csrf_token %}
		<div class="row">
			<div class="input-field col s12">
				<input  name="search" type="text" maxlength="100" value="{{ searchText }}">
				<button class="btn btn-large waves-effect waves-light" type="submit" name="action">Search</button>
				<a class="waves-effect waves-light btn btn-large">Upload</a>
			</div>
		</div>
	</form>
</div>
<div class="section">
	<div class="container">
		<div class="row">
		{% for image in images %}
		<div class="col s4">
			<div class="card">
				<div class="card-image waves-effect">
					<img class="activator thumb-img" src="{{ image.url }}" />
				</div>
				<div class="card-content">
					<span class="card-title activator">{{ image.title }}<i class="material-icons right">more_vert</i></span>
					<p>
					{{ image.number }}
					{{ image.time|date:"M d, Y, H:i:s" }}
					</p>
				</div>
				<div class="card-reveal">
					<span class="card-title">Valg<i class="material-icons right">close</i></span>
					<div class="divider"></div>
					<br>
					<ul>
						<li> <a class="waves-effect waves-light btn previewButton blue">Preview</a></li>
						<li><a class="waves-effect waves-light btn selectButton green">Select</a></li>
						<li><a class="waves-effect waves-light btn editButton orange" href="/files/image/{{ image.id }}/edit">Edit</a></li>
						<li><a url="/files/image/{{ image.id }}/delete/" class="waves-effect waves-light btn delete deleteButton red">Delete</a></li>
					</ul>
				</div>
			</div>
		</div>
		{% endfor %}
	</div>
</div>
<script>
	$(".imageItem").click(function() {
		if ($(this).hasClass("selected")) {
			$(".imageItem").removeClass("selected");
			$(".actions").css("display", "none");
		} else {
			$(".imageItem").removeClass("selected");
			$(".actions").css("display", "none");
			$(this).addClass("selected");
			$(this).children(".actions").css("display", "inline");
		}
	});

	$("#upload").click(function() {
		uploadWindow = window.open('/files/image-upload/');
	});

	$(".selectButton").click(function() {
		var src = $(this).attr("selectImage");
		var id = $(this).attr("selectID");
		window.opener.selectThumnail(src, id);
	});

	function doneUploading(src) {
		uploadWindow.close();
		location.reload();
	}
</script>

{% include 'website/delete.html' %}
{% endblock content %}
